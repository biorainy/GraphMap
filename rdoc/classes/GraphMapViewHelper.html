<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: GraphMapViewHelper</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">GraphMapViewHelper</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/lib/view_helpers_rb.html">
                lib/view_helpers.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
View helpers available to make maps
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000079">link_to_map</a>&nbsp;&nbsp;
      <a href="#M000078">plot_bitmap_map</a>&nbsp;&nbsp;
      <a href="#M000077">plot_svg_map</a>&nbsp;&nbsp;
      <a href="#M000080">plot_table</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000079" class="method-detail">
        <a name="M000079"></a>

        <div class="method-heading">
          <a href="#M000079" class="method-signature">
          <span class="method-name">link_to_map</span><span class="method-args">(link_text = 'Download', data = {}, options = { :html =&gt; {}, :map =&gt; {} })</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Links to a map. Returns an &lt;a&gt; tag pointing to the map.
</p>
<p>
<a href="GraphMapViewHelper.html#M000079">link_to_map</a>(link_text =
&#8216;Download&#8217;, data = {}, options = { :html =&gt; {}, :map =&gt;
{} })
</p>
<p>
The &#8216;data&#8217; and &#8216;options&#8217; parameters works as the
same as above. If the options[:map][:format] parameter is set as
&#8216;svg&#8217;, an SVG map will be generated, so use the same map
options as <a href="GraphMapViewHelper.html#M000077">plot_svg_map</a>.
Else, a bitmap map will be generated, so use the same map options as <a
href="GraphMapViewHelper.html#M000078">plot_bitmap_map</a>.
</p>
<p>
link_text: The text link.
</p>
<pre>
                                      Possible values: Any string
                                      Default: 'Download'
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000079-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000079-source">
<pre>
     <span class="ruby-comment cmt"># File lib/view_helpers.rb, line 170</span>
170:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">link_to_map</span>(<span class="ruby-identifier">link_text</span> = <span class="ruby-value str">'Download'</span>, <span class="ruby-identifier">data</span> = {}, <span class="ruby-identifier">options</span> = { <span class="ruby-identifier">:html</span> =<span class="ruby-operator">&gt;</span> {}, <span class="ruby-identifier">:map</span> =<span class="ruby-operator">&gt;</span> {} })
171:     <span class="ruby-identifier">map_options</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:map</span>] <span class="ruby-operator">||</span> {}
172:     <span class="ruby-identifier">html_options</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:html</span>] <span class="ruby-operator">||</span> {}
173:     <span class="ruby-identifier">map</span> = <span class="ruby-identifier">map_options</span>[<span class="ruby-identifier">:format</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'svg'</span> <span class="ruby-operator">?</span> <span class="ruby-constant">GraphMapRender</span>.<span class="ruby-identifier">make_svg_map</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">map_options</span>) <span class="ruby-operator">:</span> <span class="ruby-constant">GraphMapRender</span>.<span class="ruby-identifier">make_bitmap_map</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">map_options</span>)
174:     <span class="ruby-identifier">returning</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">result</span><span class="ruby-operator">|</span>
175:       <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:a</span>, <span class="ruby-identifier">link_text</span>, { <span class="ruby-identifier">:href</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">map</span> }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">html_options</span>))
176:     <span class="ruby-keyword kw">end</span>
177:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000078" class="method-detail">
        <a name="M000078"></a>

        <div class="method-heading">
          <a href="#M000078" class="method-signature">
          <span class="method-name">plot_bitmap_map</span><span class="method-args">(data = {}, options = { :html =&gt; {}, :map =&gt; {} })</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Plots a map in some bitmap format. Returns a img tag with the map.
</p>
<p>
data: Hash whose pairs are in format &#8217;&lt;country code&gt; =&gt;
&lt;value&gt;&#8217;. Example: { &quot;us&quot; =&gt; 125, &quot;es&quot;
=&gt; 254 } Default: {}
</p>
<p>
options: Can be HTML options or map options.
</p>
<pre>
     html: Options for the img tag that will be rendered. Any HTML attribute can be passed.
     Example: { :style =&gt; 'border: 0', :id =&gt; 'my_map', :class =&gt; 'some class' }
     Default: {}
     Possible values: Any HTML attribute

     map: Options for the map. Some of them are the same as the ones accepted by the DataMap lib.
     Example: { :title =&gt; 'Title of my map', :format =&gt; 'pdf' }
     Default: {}
     Possible values:
             format: Which format will be used to render the map.
                                       Possible values: The ones accepted by RMagick
                                        Default: GraphMapConfig.default_output_format

             range_function: What function will be used to make the values ranges. An exception will be raised if the function name
                                                                             is not recognized.
                                                                             Possible values: 'log' or 'linear'
                                                                             Default: 'log'

             log_base: What is the base of the log function, if the chosen range function is log.
                                                     Possible values: Any integer
                                                     Default: 10

             title: Title of the map.
                                      Possible values: Any string
                                      Default: No title

             legend: If the legend must be shown or not.
                                             Possible values: true or false
                                             Default: true

             palette: What color palette will be used.
                                              Possible values: The path for a color palette file. This file must be a plain text file with each line being
                                              a color in RGB format. See the default one as an example.
                                              Default: WorldMap.default_palette (data_map/palettes/tango.color)

             lang: In what language the country names will be shown.
                                     Possible values: A string representing a language. The directory data_map/lang/&lt;language&gt; must be present, with the proper
                                     files inside it. See data_map/lang/en for example.
                                     Default: WorldMap.default_language (en)

             template: The SVG template that will be used.
                                                     Possible values: The path for an SVG file.
                                                     Default: WorldMap.default_template (default_world_map.svg)

             output: The output filename (without the file extension).
                                             Possible values: Any string
                                             Default: GraphMapConfig.output

             quality: Quality of the image.
                                              Possible values: Any integer from 0 to 100
                                              Default: 100

             size: Dimensions of the image.
                                     Possible values: A size string accepted by RMagick
                                     Default: Size of the chosen template
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000078-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000078-source">
<pre>
     <span class="ruby-comment cmt"># File lib/view_helpers.rb, line 150</span>
150:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">plot_bitmap_map</span>(<span class="ruby-identifier">data</span> = {}, <span class="ruby-identifier">options</span> = { <span class="ruby-identifier">:html</span> =<span class="ruby-operator">&gt;</span> {}, <span class="ruby-identifier">:map</span> =<span class="ruby-operator">&gt;</span> {} })
151:     <span class="ruby-identifier">map_options</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:map</span>] <span class="ruby-operator">||</span> {}
152:     <span class="ruby-identifier">html_options</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:html</span>] <span class="ruby-operator">||</span> {}
153:     <span class="ruby-identifier">map</span> = <span class="ruby-constant">GraphMapRender</span>.<span class="ruby-identifier">make_bitmap_map</span> <span class="ruby-identifier">data</span>, <span class="ruby-identifier">map_options</span>
154:     <span class="ruby-identifier">returning</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">result</span><span class="ruby-operator">|</span>
155:       <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:img</span>, <span class="ruby-keyword kw">nil</span>, { <span class="ruby-identifier">:src</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">map</span> }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">html_options</span>))
156:     <span class="ruby-keyword kw">end</span>
157:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000077" class="method-detail">
        <a name="M000077"></a>

        <div class="method-heading">
          <a href="#M000077" class="method-signature">
          <span class="method-name">plot_svg_map</span><span class="method-args">(data = {}, options = { :html =&gt; {}, :map =&gt; {} })</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Plots a map in SVG format. Returns an HTML tag with an SVG map inside it.
data: Hash whose pairs are in format &#8217;&lt;country code&gt; =&gt;
&lt;value&gt;&#8217;. Example: { &quot;us&quot; =&gt; 125, &quot;es&quot;
=&gt; 254 } Default: {}
</p>
<p>
options: Can be HTML options or map options.
</p>
<pre>
     html: Options for the tag that will be rendered. Any HTML attribute can be passed.
     Example: { :style =&gt; 'border: 0', :id =&gt; 'my_map', :class =&gt; 'some class' }
     Default: {}
     Possible values: Any HTML attribute

     map: Options for the map. Some of them are the same as the ones accepted by the DataMap lib.
     Example: { :tag =&gt; 'embed', :title =&gt; 'Title of my map' }
     Default: {}
     Possible values:
             tag: Which tag will be rendered to show the SVG map. If some strange value is passed, an exception will be raised.
                              Possible values: 'embed', 'iframe' and 'object'
                              Default: 'iframe'

             use_js: If the map must be dynamic or not. Dynamic means that when the mouse is over a country, this country is highlighted
                                             and a tooltip is shown, with the country name, flag and value.
                                             Possible values: true or false
                                             Default: true

             range_function: What function will be used to make the values ranges. An exception will be raised if the function name
                                                                             is not recognized.
                                                                             Possible values: 'log' or 'linear'
                                                                             Default: 'log'

             log_base: What is the base of the log function, if the chosen range function is log.
                                                     Possible values: Any integer
                                                     Default: 10

             title: Title of the map.
                                      Possible values: Any string
                                      Default: No title

             legend: If the legend must be shown or not.
                                             Possible values: true or false
                                             Default: true

             palette: What color palette will be used.
                                              Possible values: The path for a color palette file. This file must be a plain text file with each line being
                                              a color in RGB format. See the default one as an example.
                                              Default: WorldMap.default_palette (data_map/palettes/tango.color)

             lang: In what language the country names will be shown.
                                     Possible values: A string representing a language. The directory data_map/lang/&lt;language&gt; must be present, with the proper
                                     files inside it. See data_map/lang/en for example.
                                     Default: WorldMap.default_language (en)

             template: The SVG template that will be used.
                                                     Possible values: The path for an SVG file.
                                                     Default: WorldMap.default_template (default_world_map.svg)

             output: The output filename (without the .svg extension).
                                             Possible values: Any string
                                             Default: GraphMapConfig.output
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000077-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000077-source">
<pre>
    <span class="ruby-comment cmt"># File lib/view_helpers.rb, line 64</span>
64:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">plot_svg_map</span>(<span class="ruby-identifier">data</span> = {}, <span class="ruby-identifier">options</span> = { <span class="ruby-identifier">:html</span> =<span class="ruby-operator">&gt;</span> {}, <span class="ruby-identifier">:map</span> =<span class="ruby-operator">&gt;</span> {} })
65:     <span class="ruby-identifier">map_options</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:map</span>] <span class="ruby-operator">||</span> {}
66:     <span class="ruby-identifier">html_options</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:html</span>] <span class="ruby-operator">||</span> {}
67:     <span class="ruby-identifier">map</span> = <span class="ruby-constant">GraphMapRender</span>.<span class="ruby-identifier">make_svg_map</span> <span class="ruby-identifier">data</span>, <span class="ruby-identifier">map_options</span>
68:     <span class="ruby-identifier">returning</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">result</span><span class="ruby-operator">|</span>
69:       <span class="ruby-identifier">tag</span> = <span class="ruby-identifier">map_options</span>[<span class="ruby-identifier">:tag</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">'iframe'</span>
70:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">tag</span>
71:         <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'embed'</span>
72:           <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:embed</span>, <span class="ruby-keyword kw">nil</span>, { <span class="ruby-identifier">:src</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">map</span>, 
73:                                                <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'image/svg+xml'</span>, 
74:                                                <span class="ruby-identifier">:pluginspage</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'http://www.adobe.com/svg/viewer/install/'</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">html_options</span>))
75:         <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'iframe'</span>
76:           <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:iframe</span>, <span class="ruby-keyword kw">nil</span>, { <span class="ruby-identifier">:src</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">map</span> }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">html_options</span>))
77:         <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'object'</span>
78:           <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:object</span>, <span class="ruby-keyword kw">nil</span>, { <span class="ruby-identifier">:data</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">map</span>, 
79:                                                 <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'image/svg+xml'</span>, 
80:                                                 <span class="ruby-identifier">:codebase</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'http://www.adobe.com/svg/viewer/install/'</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">html_options</span>))
81:         <span class="ruby-keyword kw">else</span>
82:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;It's not possible to insert SVG inside a '#{tag}' tag!&quot;</span>
83:       <span class="ruby-keyword kw">end</span>
84:     <span class="ruby-keyword kw">end</span>
85:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000080" class="method-detail">
        <a name="M000080"></a>

        <div class="method-heading">
          <a href="#M000080" class="method-signature">
          <span class="method-name">plot_table</span><span class="method-args">(data = {}, header = {}, html_options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Plots a table showing each value by country. Returns a &lt;table&gt; tag.
The first column are the flags, then the country names and finally the
values. The countries column and the values column are sortable (by
Javascript). The sum of all the values is shown in the last row of the
table. The country name depends on the language set in <a
href="DataMap.html">DataMap</a>.
</p>
<p>
data: Hash whose pairs are in format &#8217;&lt;country code&gt; =&gt;
&lt;value&gt;&#8217;. Example: { &quot;us&quot; =&gt; 125, &quot;es&quot;
=&gt; 254 } Default: {}
</p>
<p>
header: How the columns will be named. The keys are:
</p>
<pre>
     flag: How to call the flags column. Default: 'Flag'
     country: How to call the countries column. Default: 'Country'
     value: How to call the values column. Default: 'Value'
     country: How to call the total row. Default: 'Total'
</pre>
<p>
html_options: Options for the img tag that will be rendered. Any HTML
attribute can be passed. Example: { :style =&gt; &#8216;border: 0&#8217;,
:id =&gt; &#8216;my_map&#8217;, :class =&gt; &#8216;some class&#8217; }
Default: {} Possible values: Any HTML attribute
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000080-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000080-source">
<pre>
     <span class="ruby-comment cmt"># File lib/view_helpers.rb, line 199</span>
199:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">plot_table</span>(<span class="ruby-identifier">data</span> = {}, <span class="ruby-identifier">header</span> = {}, <span class="ruby-identifier">html_options</span> = {})
200: 
201:     <span class="ruby-identifier">strings</span> = { <span class="ruby-identifier">:flag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Flag'</span>, <span class="ruby-identifier">:country</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Country'</span>, <span class="ruby-identifier">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Value'</span>, <span class="ruby-identifier">:total</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Total'</span> }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">header</span>)
202: 
203:     <span class="ruby-identifier">total</span> = <span class="ruby-value">0</span>
204: 
205:     <span class="ruby-identifier">head</span> = [<span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:thead</span>, <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:tr</span>,
206:       [
207:         <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:th</span>, <span class="ruby-identifier">strings</span>[<span class="ruby-identifier">:flag</span>], <span class="ruby-identifier">:class</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'sorttable_nosort'</span>),
208:         <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:th</span>, <span class="ruby-identifier">strings</span>[<span class="ruby-identifier">:country</span>]),
209:         <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:th</span>, <span class="ruby-identifier">strings</span>[<span class="ruby-identifier">:value</span>]),
210:       ]
211:     ))]
212: 
213:     <span class="ruby-identifier">body</span> = []
214:     <span class="ruby-identifier">data</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">code</span>,<span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
215:       <span class="ruby-identifier">row</span> = []
216:       <span class="ruby-identifier">name</span> = <span class="ruby-constant">DataMap</span><span class="ruby-operator">::</span><span class="ruby-constant">WorldMap</span>.<span class="ruby-identifier">country_name</span>(<span class="ruby-identifier">code</span>)
217:       <span class="ruby-identifier">name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">split</span>.<span class="ruby-identifier">collect</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">w</span><span class="ruby-operator">|</span> <span class="ruby-identifier">w</span>.<span class="ruby-identifier">capitalize!</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">nil?</span>
218:       <span class="ruby-identifier">row</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:td</span>, <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:img</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:alt</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">code</span>, <span class="ruby-identifier">:src</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'/flags/'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">code</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'.png'</span>))
219:       <span class="ruby-identifier">row</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:td</span>, <span class="ruby-identifier">name</span>)
220:       <span class="ruby-identifier">row</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:td</span>, <span class="ruby-identifier">value</span>)
221:       <span class="ruby-identifier">body</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:tr</span>, <span class="ruby-identifier">row</span>.<span class="ruby-identifier">join</span>)
222:       <span class="ruby-identifier">total</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">value</span>
223:     <span class="ruby-keyword kw">end</span>
224: 
225:     <span class="ruby-identifier">foot</span> = [<span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:tfoot</span>, <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:tr</span>,
226:       [
227:         <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:td</span>, <span class="ruby-keyword kw">nil</span>),
228:         <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:td</span>, <span class="ruby-node">&quot;&lt;b&gt;#{strings[:total]}&lt;/b&gt;&quot;</span>),
229:         <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:td</span>, <span class="ruby-node">&quot;&lt;b&gt;#{total}&lt;/b&gt;&quot;</span>)
230:       ], <span class="ruby-identifier">:class</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'sortbottom'</span>
231:     ))]
232: 
233:     <span class="ruby-identifier">table</span> = [<span class="ruby-identifier">head</span>, <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:tbody</span>, <span class="ruby-identifier">body</span>), <span class="ruby-identifier">foot</span>]
234: 
235:     <span class="ruby-identifier">returning</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">result</span><span class="ruby-operator">|</span>
236:       <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:script</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'text/javascript'</span>, <span class="ruby-identifier">:src</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'/javascripts/sorttable.js'</span>)
237:       <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">content_tag</span>(<span class="ruby-identifier">:table</span>, <span class="ruby-identifier">table</span>.<span class="ruby-identifier">join</span>, { <span class="ruby-identifier">:class</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'sortable'</span> }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">html_options</span>))
238:     <span class="ruby-keyword kw">end</span>
239: 
240:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>